<!DOCTYPE html>
<html lang="kor">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Î™®ÎëêÏùò ÏûêÏú®ÌïôÏäµ, MOZA</title>
    <link rel="import" href="mainCourse.html" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap");
      header {
        color: white;
        border: 2px solid pink;
      }
      .first-line {
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        margin-bottom: 35px;
      }
      #left {
      }
      #right {
        visibility: hidden;
      }
      .tab {
        display: flex;
        justify-content: center;
        /* border: 2px solid red; */
        font-size: 60%;
        gap: 5%;
        width: 300px;
        height: auto;
      }
      .tab button {
        border-radius: 20px;
        background-color: transparent;
        color: white;
        height: 100%;
        padding: 10px;
      }
      #subjectManage {
        border: 1px solid white;
        color: white;
      }
      #gradeStatic {
        border: 1px solid grey;
        color: grey;
      }
      #studyData {
        border: 1px solid grey;
        color: grey;
      }
      .info {
        border: 1px solid red;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
      }
      .subjectTitle {
        border: 1px solid pink;
        width: 30%;
      }
      .subjectTitle span {
        border: 1px solid yellow;
        display: inline;
      }
      #roundSquare1 {
        background-color: white;
        width: 1000px;
      }
      body {
        padding: 3% 5%;
        font-family: "Nanum Gothic";
        font-weight: 400;
        background-image: url("./assets/background-main.gif");
        background-size: cover;
      }
      .quizTemplate {
        /* border: 2px solid purple; */
        border-radius: 20px;
        height: 150%;
        overflow: hidden;
        background-color: #ebf5f9;
        box-shadow: 0px 4px 7.2px rgba(0, 0, 0, 0.25);
        margin-bottom: 40px;
      }

      .quizNumber {
        font-weight: 700;
        /* border: 2px solid black; */
        border-radius: 15px;
        box-shadow: 0px 4px 7.2px rgba(0, 0, 0, 0.25);
        font-size: 150%;
        width: 7%;
        height: 70px;
        float: left;
        margin-top: 20px;
        margin-left: 20px;
        color: #1681ff;
        background-color: white;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      .quizSpec {
        /* border: 2px solid red; */
        margin-top: 20px;
        margin-left: 20px;
        width: 75%;
        float: left;
        margin-bottom: 20px;
      }
      .quizQuest {
        /* border: 2px solid green; */
        box-shadow: 0px 4px 7.2px rgba(0, 0, 0, 0.25);
        width: auto;
        border-radius: 10px;
        font-size: 120%;
        padding: 1.5%;
        line-height: 130%;
        background-color: rgba(255, 255, 255, 0.8);
      }
      .quizAnswer {
        /* border: 2px solid blue; */
        box-shadow: 0px 4px 7.2px rgba(0, 0, 0, 0.25);
        border-radius: 10px;
        border: none;
        width: 100%;
        box-sizing: border-box;
        margin-top: 15px;
        font-size: 120%;
        padding: 1.2%;
        line-height: 130%;
        outline: none;
        font-family: "Nanum Gothic";
        background-color: (225, 225, 225, 0.8);
      }

      .ansJudge {
        box-shadow: 0px 4px 7.2px rgba(0, 0, 0, 0.25);
        width: auto;
        border-radius: 5px;
        font-size: 120%;
        padding: 1.5%;
        line-height: 130%;
        background-color: rgba(255, 255, 255, 0.8);
      }
      .quizSol {
        box-shadow: 0px 4px 7.2px rgba(0, 0, 0, 0.25);
        width: auto;
        border-radius: 5px;
        font-size: 120%;
        padding: 1.5%;
        line-height: 130%;
        background-color: rgba(255, 255, 255, 0.8);
      }

      .quizButton {
        /* border: 2px solid black; */
        margin-top: 20px;
        margin-right: 20px;
        float: right;
        justify-content: center;
        text-align: right;
        width: 11%;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }
      button:active {
        box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.2);
      }
      button {
        border-radius: 20px;
        width: 100%;
        height: 50px;
        box-shadow: 0px 4px 7.2px rgba(0, 0, 0, 0.25);
        border: none;
        font-size: 130%;
        color: white;
        background-color: #ff8b8be3;
      }
      button:hover {
        cursor: pointer;
      }
      #answerSubmit {
        background-color: #ff8b8be3;
      }
      #showSolve {
        background-color: #1683ffa4;
      }
    </style>
  </head>
  <body>
    <header id="quizHeader"></header>
    <div id="quizContainer"></div>

    <script>
      const title = "mainCourseÏóêÏÑú Î∞õÏïÑÏò¨ Ï†úÎ™©";
      const quizNumber = "NO.";
      const quizExample = "APIÏóêÏÑú ÎÑòÏñ¥Ïò¨ Î¨∏Ï†ú";

      document.addEventListener("DOMContentLoaded", function () {
        // 1. Ìó§Îçî Î†åÎçîÎßÅ ÌïòÍ∏∞
        createHeader(title);
        // 2. ÏÑúÎ≤ÑÏóêÏÑú Ïä§ÌÜ†Î¶¨ÏßÄ Ï†§ ÏµúÍ∑º subjectId Í∞í Í∞ÄÏßÄÍ≥† ÏÑúÎ≤ÑÏóêÏÑú json data Î∞õÍ∏∞
        // const recentId = localStorage.getItem("subjectId");
        // if (recentId) {
        //   console.log("subjectId: ", recentId);
        // } else {
        //   console.log("subjectId Îã§Ïãú Í∞ñÍ≥† ÏôÄ.");
        // }

        // ÏïÑÎûòÎäî ÌÖåÏä§Ìä∏Ïö© Îç∞Ïù¥ÌÑ∞ÏûÑ
        var jsonData = {
          problem: [
            {
              id: "234",
              title: "ÏïåÍ≥†Î¶¨Ï¶ò Í∞úÎÖê",
              question: "Î≤ÑÎ∏î Ï†ïÎ†¨Ïóê ÎåÄÌï¥ ÏûêÏú†Î°≠Í≤å ÏÑúÏà†ÌïòÏãúÏò§",
            },
            {
              id: "238",
              title: "ÏïåÍ≥†Î¶¨Ï¶ò Í∞úÎÖê",
              question: "Î≤ÑÎ∏î Ï†ïÎ†¨Ïóê ÎåÄÌï¥ ÏûêÏú†Î°≠Í≤å ÏÑúÏà†ÌïòÏãúÏò§",
            },
            {
              id: "239",
              title: "ÏûêÎ£åÍµ¨Ï°∞",
              question: "Ïä§ÌÉùÍ≥º ÌÅêÏùò Ï∞®Ïù¥Ï†êÏùÑ ÏÑ§Î™ÖÌïòÏãúÏò§",
            },
            {
              id: "240",
              title: "ÏûêÎ£åÍµ¨Ï°∞",
              question: "Ïù¥ÏßÑ Ìä∏Î¶¨Ïùò ÌäπÏßïÏùÑ ÏÑ§Î™ÖÌïòÏãúÏò§",
            },
            {
              id: "241",
              title: "ÎÑ§Ìä∏ÏõåÌÅ¨",
              question: "TCPÏôÄ UDPÏùò Ï∞®Ïù¥Ï†êÏùÑ ÏÑ§Î™ÖÌïòÏãúÏò§",
            },
            {
              id: "242",
              title: "Ïö¥ÏòÅÏ≤¥Ï†ú",
              question: "ÌîÑÎ°úÏÑ∏Ïä§ÏôÄ Ïä§Î†àÎìúÏùò Ï∞®Ïù¥Ï†êÏùÑ ÏÑ§Î™ÖÌïòÏãúÏò§",
            },
          ],
        };

        // var recentjsonData = "{ 'subjectId': " + recentId + " }";
        // fetch(`https://apict.pnu.app/quiz/${recentId}`), {
        fetch("https://apict.pnu.app/quiz/3"),
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(recentjsonData),
          }
            .then((response) => {
              if (!response.ok) {
                throw new Error("ÎÑ§Ìä∏ÏõåÌÅ¨ ÏùëÎãµÏù¥ Ïò≥ÏßÄ ÏïäÏäµÎãàÎã§.");
                console.log("recentId: ", recentId);
              }
              return response.json();
            })
            .then((data) => {
              console.log("ÏÑ±Í≥µÏ†ÅÏù∏ ÏùëÎãµ: ", data);
              // 3. Î∞õÏùÄ Îç∞Ïù¥ÌÑ∞Î•º Ïù¥Ïö©ÌïòÏó¨ Ïª¥Ìè¨ÎÑåÌä∏ ÏÉùÏÑ±ÌïòÍ∏∞
              createComponent(data);
            });
        createComponent(jsonData);
      });

      function createHeader(subject) {
        var header = document.createElement("header");

        var first = document.createElement("div");
        first.classList.add("first-line");
        header.appendChild(first);

        var logoImg = document.createElement("img");
        logoImg.src = "./assets/MOZA.svg";
        logoImg.style.width = "7%";
        logoImg.setAttribute("id", "left");
        first.appendChild(logoImg);

        var tabDiv = document.createElement("div");
        tabDiv.classList.add("tab");
        first.appendChild(tabDiv);

        var logoImg2 = document.createElement("img");
        logoImg2.src = "./assets/MOZA.svg";
        logoImg2.style.width = "7%";
        logoImg2.setAttribute("id", "right");
        first.appendChild(logoImg2);

        var subjectManageBtn = document.createElement("button");
        subjectManageBtn.id = "subjectManage";
        subjectManageBtn.textContent = "Í≥ºÎ™© Í¥ÄÎ¶¨";
        tabDiv.appendChild(subjectManageBtn);

        var gradeStaticBtn = document.createElement("button");
        gradeStaticBtn.id = "gradeStatic";
        gradeStaticBtn.textContent = "ÏÑ±Ï†Å ÌÜµÍ≥Ñ";
        tabDiv.appendChild(gradeStaticBtn);

        var studyDataBtn = document.createElement("button");
        studyDataBtn.id = "studyData";
        studyDataBtn.textContent = "ÌïôÏäµ Îç∞Ïù¥ÌÑ∞";
        tabDiv.appendChild(studyDataBtn);

        var infoDiv = document.createElement("div");
        infoDiv.classList.add("info");

        var subjectTitleDiv = document.createElement("div");
        subjectTitleDiv.classList.add("subjectTitle");
        subjectTitleDiv.textContent = subject;
        var roundSquare1 = document.createElement("div");
        roundSquare1.setAttribute("id", "roundSquare1");
        subjectTitleDiv.appendChild(roundSquare1);
        infoDiv.appendChild(subjectTitleDiv);

        var cheerPhraseSpan = document.createElement("span");
        cheerPhraseSpan.classList.add("cheerPhrase");
        cheerPhraseSpan.textContent = "Ï§ëÍ∞ÑÍ≥†ÏÇ¨ÍπåÏßÄ D-7üî• Ìï† Ïàò ÏûàÎã§!!";
        infoDiv.appendChild(cheerPhraseSpan);

        var progressGraphDiv = document.createElement("div");
        progressGraphDiv.classList.add("progressGraph");
        var progressSpan1 = document.createElement("span");
        progressSpan1.textContent = "ÏßÑÎèÑÏú®";
        progressGraphDiv.appendChild(progressSpan1);
        var progressSpan2 = document.createElement("span");
        progressSpan2.innerHTML = "ÏßÑÎèÑÏú®<br>Í∑∏ÎûòÌîÑ";
        progressGraphDiv.appendChild(progressSpan2);
        infoDiv.appendChild(progressGraphDiv);

        var roundSquare2 = document.createElement("div");
        roundSquare2.setAttribute("id", "roundSquare2");
        // roundSquare2 ÏÜçÏÑ± Ï∂îÍ∞ÄÌï¥Ï£ºÍ∏∞
        progressGraphDiv.appendChild(roundSquare2);

        var studyPeriod = document.createElement("span");
        studyPeriod.textContent = "ÌïôÏäµ Í∏∞Í∞Ñ";
        infoDiv.appendChild(studyPeriod);
        var studyPeriod2 = document.createElement("span");
        studyPeriod.textContent = "0000.00.00 ~ 0000.00.00";
        infoDiv.appendChild(studyPeriod2);

        header.appendChild(infoDiv);

        document.body.insertBefore(header, document.body.firstChild);
      }

      function createComponent(data) {
        var quizHeader = document.getElementById("quizHeader");
        var quizIndex = 1;
        data.problem.forEach(function (item) {
          var quizTemplate = document.createElement("div");
          quizTemplate.classList.add("quizTemplate");

          var quizNumber = document.createElement("div");
          quizNumber.classList.add("quizNumber");
          quizNumber.textContent = quizIndex++;

          var quizSpec = document.createElement("div");
          quizSpec.classList.add("quizSpec");

          var quizQuest = document.createElement("div");
          quizQuest.classList.add("quizQuest");
          quizQuest.textContent = item.question;

          var quizAnswer = document.createElement("textarea");
          quizAnswer.classList.add("quizAnswer");
          quizAnswer.placeholder = "ÎãµÎ≥Ä ÏûÖÎ†• Ïπ∏";

          var quizButton = document.createElement("div");
          quizButton.classList.add("quizButton");

          var answerSubmit = document.createElement("button");
          answerSubmit.setAttribute("id", "answerSubmit");
          answerSubmit.textContent = "Ï†úÏ∂úÌïòÍ∏∞";
          answerSubmit.addEventListener("click", function () {
            var answerVal = quizAnswer.value;
            var problemId = item.id;
            var jsonData = "{ 'user_answer': " + answerVal + " }";
            // var jsonData = {
            //   user_answer: answerVal,
            // };
            fetch(`https://apict.pnu.app/problem/${jsonData.problemId}`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(jsonData),
            })
              .then((response) => {
                if (!response.ok) {
                  throw new Error("ÎÑ§Ìä∏ÏõåÌÅ¨ ÏùëÎãµÏù¥ Ïò≥ÏßÄ ÏïäÏäµÎãàÎã§.");
                  console.log("problemId: ", problemId);
                }
                return response.json();
              })
              .then((data) => {
                console.log("ÏÑ±Í≥µÏ†ÅÏù∏ ÏùëÎãµ: ", data);
                var ansJudge = document.createElement("div");
                ansJudge.classList.add("ansJudge");
                var judgeTF = JSON.stringfy(data.is_correct);
                if (judgeTF == "true") {
                  judgeTF = "Ï†ïÎãµÏûÖÎãàÎã§.";
                } else {
                  judgeTF = "Ïò§ÎãµÏûÖÎãàÎã§.";
                }
                ansJudge.textContent = judgeTF;
                quizSpec.appendChild(ansJudge);
              })
              .catch((error) => {
                console.error("Ïã§Ìå®Ìïú ÏùëÎãµ: ", error);
                console.log("problemId: ", problemId);
              });
          });

          var showSolve = document.createElement("button");
          showSolve.setAttribute("id", "showSolve");
          showSolve.textContent = "ÌíÄÏù¥Î≥¥Í∏∞";
          showSolve.addEventListener("click", function () {
            var quizId = item.id;
            var jsonData = "{ 'id': " + quizId + " }";
            // var jsonData = {
            //   id: quizId,
            // };
            fetch(`https://apict.pnu.app/solution/${jsonData.quizId}`, {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(jsonData),
            })
              .then((response) => {
                if (!response.ok) {
                  throw new Error("ÎÑ§Ìä∏ÏõåÌÅ¨ ÏùëÎãµÏù¥ Ïò≥ÏßÄ ÏïäÏäµÎãàÎã§.");
                  console.log("quizId: ", quizId);
                }
                return response.json();
              })
              .then((data) => {
                console.log("ÏÑ±Í≥µÏ†ÅÏù∏ ÏùëÎãµ: ", data);
                var quizSol = document.createElement("div");
                quizSol.classList.add("quizSol");
                quizSol.textContent = JSON.stringify(data);
                quizSpec.appendChild(quizSol);
              })
              .catch((error) => {
                console.error("Ïã§Ìå®Ìïú ÏùëÎãµ: ", error);
                console.log("quizId: ", quizId);
              });
          });

          quizSpec.appendChild(quizQuest);
          quizSpec.appendChild(quizAnswer);

          quizButton.appendChild(answerSubmit);
          quizButton.appendChild(showSolve);

          quizTemplate.appendChild(quizNumber);
          quizTemplate.appendChild(quizSpec);
          quizTemplate.appendChild(quizButton);

          quizContainer.appendChild(quizTemplate);
        });
      }
    </script>
  </body>
</html>
